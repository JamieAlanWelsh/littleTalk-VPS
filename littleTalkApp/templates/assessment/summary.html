{% extends "base.html" %}
{% load static %}

{% block title %}Chatterdillo | Screener{% endblock %}

{% block content %}

{% comment %} Simplified Header for Assessment Page {% endcomment %}
<!-- logo top left -->
<a href="/" class="logo-link">
    <div class="logo-upper-left">
        <img src="{% static 'images/chatterdillo_logo_official.png' %}" alt="Chatterdillo Logo">
    </div>
</a>


<div class="summary-wrapper">
    <section>
        {% if readiness_status == "not_ready" %}
            <div class="container-box container--white container--edgy marginsupperlower-30 printable-section">
                <p class="summary-intro"><strong>Chatterdillo may not be suitable for {{ learner.name }} at this time.</strong></p>
                <p>It seems like {{ learner.name }} may be struggling with attention and listening skills. We can still support you but our exercises will be most effective once they have developed this skill.</a>.</p>
            </div>
        {% elif readiness_status == "ready" %}
            <div class="container-box container--white container--edgy marginsupperlower-30 printable-section">
                <p class="summary-intro"><strong>Great news! Chatterdillo is likely a good fit for {{ learner.name }}!</strong></p>
                <p>{{ learner.name }} appears to have strong attention and listening skills. Our exercises are well-equipped to support their language development.</p>
            </div>
        {% endif %}

        <div class="summary-button-row no-print">
            <a href="{% url 'profile' %}" class="btn btn--white btn--full btn--small">Back to Profile</a>
            <a href="{% url 'practise' %}" class="btn btn--white btn--full btn--small">Go to Recommendations</a>
        </div>

        {% if has_previous %}
        <div class="container-box container--white container--edgy marginsupperlower-30 printable-section">
            <div class="summary-header">
                <p class="summary-intro">
                    <strong>Progress Since Last Screener</strong>
                </p>
                <button onclick="printScreenerSummary()" class="btn btn--white btn--small btn--border no-print">ðŸ–¨ Print Progress</button>
            </div>
            <p class="comparison-note">Last screener completed: <strong>{{ previous_session_date|date:"M d, Y" }}</strong></p>

            {% if skills_gained %}
            <div class="comparison-section skills-gained">
                <p><strong>âœ“ Skills Gained:</strong></p>
                <ul class="skill-list skill-list--gained">
                    {% for skill in skills_gained %}
                        <li><span class="skill-indicator skill-indicator--gained">âœ“</span> {{ skill }}</li>
                    {% endfor %}
                </ul>
                <p class="comparison-note">{{ learner.name }} now shows strong skills in these areas.</p>
            </div>
            {% endif %}

            {% if skills_lost %}
            <div class="comparison-section skills-lost">
                <p><strong>âš  Areas Showing Fluctuation:</strong></p>
                <ul class="skill-list skill-list--lost">
                    {% for skill in skills_lost %}
                        <li><span class="skill-indicator skill-indicator--lost">âš </span> {{ skill }}</li>
                    {% endfor %}
                </ul>
                <p class="comparison-note">Skills can naturally fluctuate as children develop. These areas may benefit from continued practice.</p>
            </div>
            {% endif %}

            {% if skills_maintained_strong %}
            <div class="comparison-section skills-maintained">
                <p><strong>Maintained Strengths:</strong></p>
                <ul class="skill-list skill-list--maintained">
                    {% for skill in skills_maintained_strong %}
                        <li>{{ skill }}</li>
                    {% endfor %}
                </ul>
            </div>
            {% endif %}

            {% if recommendation_change.direction %}
            <div class="recommendation-info">
                <span class="info-icon">i</span>
                {% if recommendation_change.direction == "improved" %}
                    <p>{{ learner.name }} has improved! Recommendation level has adjusted - consider more advanced exercises.</p>
                {% elif recommendation_change.direction == "declined" %}
                    <p>Recommendation level has adjusted. Focus on foundational skills before advancing.</p>
                {% else %}
                    <p>Results are consistent with previous screener.</p>
                {% endif %}
            </div>
            {% endif %}
        </div>
        {% endif %}

        <div class="container-box container--white container--edgy marginsupperlower-30 printable-section">

            <div class="summary-header">
                <p class="summary-intro">
                    <strong>Current Screener Results</strong>
                </p>
                <button onclick="printScreenerSummary()" class="btn btn--white btn--small btn--border no-print">ðŸ–¨ Print Summary</button>
            </div>

            {% if strong_skills %}
                <p><strong>{{ learner.name }} has strong skills in:</strong></p>
                <ul class="skill-list">
                    {% for skill in strong_skills %}
                        <li>{{ skill }}</li>
                    {% endfor %}
                </ul>
            {% endif %}

            {% if needs_support_skills %}
                <p><strong>{{ learner.name }} may need support with:</strong></p>
                <ul class="skill-list">
                    {% for skill in needs_support_skills %}
                        <li>{{ skill }}</li>
                    {% endfor %}
                </ul>
            {% endif %}
        </div>

    </section>
</div>

<script src="{% static 'js/print_utils.js' %}"></script>
{% endblock %}